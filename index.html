<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å®ãã˜ã§å„„ä¸‡é•·è€…ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    body {
      font-family: 'Hiragino Kaku Gothic ProN', sans-serif;
      background: #fff8e1;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 1.8rem;
    }
    #money {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    select, button {
      padding: 10px 20px;
      font-size: 1rem;
      margin: 10px;
    }
    button {
      background-color: #ff9800;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    #result {
      margin-top: 30px;
      font-size: 1.1rem;
      white-space: pre-wrap;
    }
    .loss {
      color: red;
      font-weight: bold;
    }
    #share a {
      text-decoration: none;
      background: #1da1f2;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <h1>å®ãã˜ã§å„„ä¸‡é•·è€…ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
  <div id="money">æ‰€æŒé‡‘ï¼š1,000,000å††</div>

  <label for="ticketCount">è³¼å…¥é‡‘é¡ã‚’é¸æŠï¼š</label>
  <select id="ticketCount">
    <option value="10">3,000å††ï¼ˆ10æšï¼‰</option>
    <option value="33">10,000å††ï¼ˆ33æšï¼‰</option>
    <option value="100">30,000å††ï¼ˆ100æšãƒ»ä¸Šé™ï¼‰</option>
  </select>
  <br />
  <button onclick="drawLottery()">å®ãã˜ã‚’è³¼å…¥ï¼ˆ1å›é™ã‚Šï¼‰</button>

  <div id="result"></div>

  <div id="share" style="margin-top: 20px; display: none;">
    <a id="tweetBtn" href="#" target="_blank">çµæœã‚’Xã§ã‚·ã‚§ã‚¢ã™ã‚‹</a>
  </div>

  <script>
    let money = 1000000;
    const ticketPrice = 300;

    function pad(num) {
      return num.toString().padStart(6, '0');
    }

    function drawLottery() {
      const btn = document.querySelector("button");
      btn.disabled = true;
      document.getElementById("ticketCount").disabled = true;

      const count = parseInt(document.getElementById("ticketCount").value);
      const cost = count * ticketPrice;
      money -= cost;

      const yourNumbers = Array.from({length: count}, () =>
        pad(Math.floor(Math.random() * 1000000))
      );

      const winners = {
        '1ç­‰': pad(Math.floor(Math.random() * 1000000)),
        '2ç­‰': pad(Math.floor(Math.random() * 1000000)),
        '3ç­‰': pad(Math.floor(Math.random() * 1000000)),
        '4ç­‰': pad(Math.floor(Math.random() * 1000)), // ä¸‹3æ¡
        '5ç­‰': Math.floor(Math.random() * 10).toString() // ä¸‹1æ¡
      };

      const rewards = {
        '1ç­‰': 1000000000,
        '2ç­‰': 10000000,
        '3ç­‰': 1000000,
        '4ç­‰': 10000,
        '5ç­‰': 3000
      };

      let result = `ğŸ’¸ ${count}æšï¼ˆ${cost.toLocaleString()}å††ï¼‰åˆ†è³¼å…¥\n\n`;
      result += `ğŸ¯ å½“é¸ç•ªå·ï¼š\n`;
      result += `1ç­‰ï¼š${winners['1ç­‰']}\n`;
      result += `2ç­‰ï¼š${winners['2ç­‰']}\n`;
      result += `3ç­‰ï¼š${winners['3ç­‰']}\n`;
      result += `4ç­‰ï¼ˆä¸‹3æ¡ï¼‰ï¼š${winners['4ç­‰']}\n`;
      result += `5ç­‰ï¼ˆä¸‹1æ¡ï¼‰ï¼š${winners['5ç­‰']}\n\n`;

      let totalWin = 0;

      yourNumbers.forEach((num, idx) => {
        let hit = '';
        let prize = 0;

        if (num === winners['1ç­‰']) {
          hit = 'ğŸ‰ 1ç­‰å½“é¸ï¼10å„„å††ï¼';
          prize = rewards['1ç­‰'];
        } else if (num === winners['2ç­‰']) {
          hit = 'ğŸ‰ 2ç­‰å½“é¸ï¼1,000ä¸‡å††ï¼';
          prize = rewards['2ç­‰'];
        } else if (num === winners['3ç­‰']) {
          hit = 'ğŸ‰ 3ç­‰å½“é¸ï¼100ä¸‡å††ï¼';
          prize = rewards['3ç­‰'];
        } else if (num.slice(-3) === winners['4ç­‰']) {
          hit = 'ğŸ˜Š 4ç­‰å½“é¸ï¼1ä¸‡å††ï¼';
          prize = rewards['4ç­‰'];
        } else if (num.slice(-1) === winners['5ç­‰']) {
          hit = 'ğŸ™‚ 5ç­‰å½“é¸ï¼3,000å††ï¼';
          prize = rewards['5ç­‰'];
        } else {
          hit = 'ğŸ˜¢ ãƒã‚ºãƒ¬';
        }

        totalWin += prize;
        result += `ğŸŸ ${idx + 1}æšç›®ï¼š${num} â†’ ${hit}\n`;
      });

      const profit = totalWin - cost;
      money += totalWin;

      result += `\nğŸ’° å½“é¸é‡‘é¡ï¼š${totalWin.toLocaleString()}å††`;
      result += `\nğŸ“Š æç›Šï¼š${profit >= 0 ? '+' : ''}${profit.toLocaleString()}å††`;
      result += `\nğŸ’¼ æ®‹ã‚Šè³‡ç”£ï¼š${money.toLocaleString()}å††`;

      document.getElementById("money").innerHTML = `æ‰€æŒé‡‘ï¼š<span class="loss">${money.toLocaleString()}å††</span>`;
      document.getElementById("result").textContent = result;

      // ãƒ„ã‚¤ãƒ¼ãƒˆæ–‡ä½œæˆ
      const tweetText = encodeURIComponent(
        `ã€å®ãã˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ğŸ¯ã€‘\n` +
        `è³¼å…¥ï¼š${count}æšï¼ˆ${cost.toLocaleString()}å††ï¼‰\n` +
        `å½“é¸é‡‘é¡ï¼š${totalWin.toLocaleString()}å††\n` +
        `æç›Šï¼š${profit >= 0 ? '+' : ''}${profit.toLocaleString()}å††\n` +
        `${profit >= 0 ? 'ã‚„ã£ãŸãƒ¼ï¼å¤¢ã‚ã‚‹ï¼' : 'æº¶ã‘ãŸâ€¦ç¾å®Ÿã€‚'}\n` +
        `#å®ãã˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼`
      );
      const tweetUrl = `https://twitter.com/intent/tweet?text=${tweetText}&url=https://kkp-15.github.io/ninja-takarakuji-sim/`;
      document.getElementById("tweetBtn").href = tweetUrl;
      document.getElementById("share").style.display = "block";
    }
  </script>
</body>
</html>
