<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>宝くじで億万長者シミュレーター</title>
  <style>
    body {
      font-family: 'Hiragino Kaku Gothic ProN', sans-serif;
      background: #fff8e1;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 1.8rem;
    }
    #money {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    select, button {
      padding: 10px 20px;
      font-size: 1rem;
      margin: 10px;
    }
    button {
      background-color: #ff9800;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    #result {
      margin-top: 30px;
      font-size: 1.1rem;
      white-space: pre-wrap;
    }
    .loss {
      color: red;
      font-weight: bold;
    }
    #share a {
      text-decoration: none;
      background: #1da1f2;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <h1>宝くじで億万長者シミュレーター</h1>
  <div id="money">所持金：1,000,000円</div>

  <label for="ticketCount">購入金額を選択：</label>
  <select id="ticketCount">
    <option value="10">3,000円（10枚）</option>
    <option value="33">10,000円（33枚）</option>
    <option value="100">30,000円（100枚・上限）</option>
  </select>
  <br />
  <button onclick="drawLottery()">宝くじを購入（1回限り）</button>

  <div id="result"></div>

  <div id="share" style="margin-top: 20px; display: none;">
    <a id="tweetBtn" href="#" target="_blank">結果をXでシェアする</a>
  </div>

  <script>
    let money = 1000000;
    const ticketPrice = 300;

    function pad(num) {
      return num.toString().padStart(6, '0');
    }

    function drawLottery() {
      const btn = document.querySelector("button");
      btn.disabled = true;
      document.getElementById("ticketCount").disabled = true;

      const count = parseInt(document.getElementById("ticketCount").value);
      const cost = count * ticketPrice;
      money -= cost;

      const yourNumbers = Array.from({length: count}, () =>
        pad(Math.floor(Math.random() * 1000000))
      );

      const winners = {
        '1等': pad(Math.floor(Math.random() * 1000000)),
        '2等': pad(Math.floor(Math.random() * 1000000)),
        '3等': pad(Math.floor(Math.random() * 1000000)),
        '4等': pad(Math.floor(Math.random() * 1000)), // 下3桁
        '5等': Math.floor(Math.random() * 10).toString() // 下1桁
      };

      const rewards = {
        '1等': 1000000000,
        '2等': 10000000,
        '3等': 1000000,
        '4等': 10000,
        '5等': 3000
      };

      let result = `💸 ${count}枚（${cost.toLocaleString()}円）分購入\n\n`;
      result += `🎯 当選番号：\n`;
      result += `1等：${winners['1等']}\n`;
      result += `2等：${winners['2等']}\n`;
      result += `3等：${winners['3等']}\n`;
      result += `4等（下3桁）：${winners['4等']}\n`;
      result += `5等（下1桁）：${winners['5等']}\n\n`;

      let totalWin = 0;

      yourNumbers.forEach((num, idx) => {
        let hit = '';
        let prize = 0;

        if (num === winners['1等']) {
          hit = '🎉 1等当選！10億円！';
          prize = rewards['1等'];
        } else if (num === winners['2等']) {
          hit = '🎉 2等当選！1,000万円！';
          prize = rewards['2等'];
        } else if (num === winners['3等']) {
          hit = '🎉 3等当選！100万円！';
          prize = rewards['3等'];
        } else if (num.slice(-3) === winners['4等']) {
          hit = '😊 4等当選！1万円！';
          prize = rewards['4等'];
        } else if (num.slice(-1) === winners['5等']) {
          hit = '🙂 5等当選！3,000円！';
          prize = rewards['5等'];
        } else {
          hit = '😢 ハズレ';
        }

        totalWin += prize;
        result += `🎟 ${idx + 1}枚目：${num} → ${hit}\n`;
      });

      const profit = totalWin - cost;
      money += totalWin;

      result += `\n💰 当選金額：${totalWin.toLocaleString()}円`;
      result += `\n📊 損益：${profit >= 0 ? '+' : ''}${profit.toLocaleString()}円`;
      result += `\n💼 残り資産：${money.toLocaleString()}円`;

      document.getElementById("money").innerHTML = `所持金：<span class="loss">${money.toLocaleString()}円</span>`;
      document.getElementById("result").textContent = result;

      // ツイート文作成
      const tweetText = encodeURIComponent(
        `【宝くじシミュレーター🎯】\n` +
        `購入：${count}枚（${cost.toLocaleString()}円）\n` +
        `当選金額：${totalWin.toLocaleString()}円\n` +
        `損益：${profit >= 0 ? '+' : ''}${profit.toLocaleString()}円\n` +
        `${profit >= 0 ? 'やったー！夢ある！' : '溶けた…現実。'}\n` +
        `#宝くじシミュレーター`
      );
      const tweetUrl = `https://twitter.com/intent/tweet?text=${tweetText}&url=https://kkp-15.github.io/ninja-takarakuji-sim/`;
      document.getElementById("tweetBtn").href = tweetUrl;
      document.getElementById("share").style.display = "block";
    }
  </script>
</body>
</html>
